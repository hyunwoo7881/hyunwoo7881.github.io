<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by Youssef Raafat
  Free for personal and commercial use under the MIT license
  https://github.com/YoussefRaafatNasry/portfolYOU
  Updates for JPN Fall 2024
  FALL2024ID49073
-->

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="SQL 분석 프로젝트 - eCommerce">
  <meta property="og:description" content="This project visualizes key U.S. weather data, exploring temperatu$">
  <meta property="og:image" content="assets/pngs/usmap.jpg">

  <title>SQL 분석 프로젝트 - eCommerce</title>
  <meta name="description" content="This project visualizes key U.S. weather data, exploring temperatu$">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>

<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>Hyunwoo Park's Resume</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link " href="/license_trends">My GitHub Pages with Streamlit</a>

      <a class="nav-item nav-link active" href="/projects/">Projects</a>

      <a class="nav-item nav-link " href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  <h2 id="sql-분석-프로젝트---ecommerce">SQL 분석 프로젝트 - eCommerce</h2>
<p><br /><br /></p>

<h3 id="분석의-목적">분석의 목적</h3>
<p>이 프로젝트는 eCommerce 데이터를 활용하여 마케팅 채널 분석, 웹사이트 퍼포먼스 측정, 제품 포트폴리오 분석을 수행하는 것을 목표로 한다. 특히, 트래픽 소스별 성과를 분석하고, 브랜드 인지도의 성장 여부를 평가하며, A/B 테스트를 통해 랜딩 페이지 변경이 수익에 미치는 영향을 확인한다.</p>

<ul>
  <li>데이터베이스 설명:
    <ul>
      <li>UTM sources로는 gsearch(Google)와 bsearch(Bing).</li>
      <li>UTM capmaigns로는 nonbrand와 brand.
        <ul>
          <li>(nonbrand 그룹은 제품의 카테고리 또는 관련 검색어로 찾아온 고객들 / brand 그룹은 브랜드의 이름을 검색해서 들어온 고객들.)</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>프로젝트 배경:
    <ul>
      <li>상황: 8개월된 인터넷 소매업체가 있고, CEO가 프레젠테이션에 필요한 회사의 performance metrics가 필요한 상황.</li>
      <li>목표: performance 데이터와 웹 트래픽등을 SQL로 추출하고, 회사의 성장을 수치화하고 분석하기.</li>
    </ul>
  </li>
</ul>

<p><br /><br />
<br /><br /></p>
<h3 id="결과">결과</h3>
<ul>
  <li><strong>Gsearch 트래픽 증가</strong>:</li>
</ul>

<blockquote>
  <p>Gsearch(구글 광고)에서 발생한 세션 수가 꾸준히 증가하며, 주문 수 및 전환율 또한 상승하는 경향을 보였다. 첫 달 1,860건에서 시작하여 마지막 달에는 8,895건으로 증가하였으며, 주문 수 역시 92건에서 373건으로 약 4배 증가하였다. 전환율 또한 2.6%에서 4%로 상승하여 광고 캠페인이 지속적으로 성과를 내고 있음을 보여준다.</p>
</blockquote>

<ul>
  <li><strong>Brand vs. Nonbrand 비교</strong>:</li>
</ul>

<blockquote>
  <p>브랜드 키워드를 검색한 고객들의 세션 수가 비약적으로 증가하여, 브랜드 인지도가 상승했음을 시사한다. 특히 브랜드 검색 트래픽이 지속적으로 증가하면서, 유료 광고 트래픽의 의존도를 줄이고 브랜드 자체의 검색 유입이 늘어나고 있다. 이는 장기적으로 광고 비용 절감과 브랜드 가치 향상에 기여할 가능성이 있다.</p>
</blockquote>

<ul>
  <li><strong>기기별 Nonbrand 분석</strong>:</li>
</ul>

<blockquote>
  <p>Nonbrand 검색을 통한 트래픽에서 데스크탑과 모바일의 비율이 초기 2:1에서 3:1로 확대되었으며, 주문 수에서도 유사한 변화가 나타났다. 특히, 모바일 트래픽이 증가하는 속도가 빠르지만, 여전히 데스크탑에서의 전환율이 높게 유지되는 경향을 보였다. 이는 모바일 UX 최적화가 필요할 수 있음을 시사하며, 향후 데이터 분석을 통해 모바일 고객의 구매 여정을 더욱 세밀하게 파악할 필요가 있다.</p>
</blockquote>

<ul>
  <li><strong>Gsearch 트래픽 비율 분석</strong>:</li>
</ul>

<blockquote>
  <p>전체 트래픽에서 Gsearch의 비중이 지나치게 높은 것으로 나타났다. 유료 검색 채널뿐만 아니라, organic search 및 direct 유입 비율도 증가하고 있어 자연 유입을 더욱 강화할 필요가 있다. 이는 마케팅 전략을 조정하여 광고 비용 대비 효과적인 고객 확보 전략을 수립할 기회를 제공한다.</p>
</blockquote>

<ul>
  <li><strong>A/B 테스트 결과</strong>:</li>
</ul>

<blockquote>
  <p>새로운 랜딩 페이지(l/lander-1)의 전환율이 기존 홈페이지(/home)보다 약 0.88% 더 높은 것으로 나타났으며, 실험 이후 4개월간 약 50건의 추가 주문이 발생했다. 특히 실험 이후 새로운 랜딩 페이지로 유입된 트래픽이 증가하며, 전환율이 꾸준히 향상되는 경향을 보였다.</p>
</blockquote>

<p><br /><br />
<br /><br /></p>
<h3 id="제안">제안</h3>
<ol>
  <li>
    <p>브랜드 트래픽 강화: 브랜드 검색을 통해 유입되는 사용자가 증가하는 경향이므로, 장기적으로 유료 광고 의존도를 줄이고 브랜드 인지도를 높이는 전략이 필요하다.</p>
  </li>
  <li>
    <p>모바일 UX 개선: 모바일을 통한 트래픽 비율이 증가하고 있으므로, 모바일 최적화된 UX/UI 개선을 통해 전환율을 더욱 향상시킬 수 있다.</p>
  </li>
  <li>
    <p>랜딩 페이지 최적화: A/B 테스트 결과를 반영하여, 전환율이 더 높은 l/lander-1을 기본 랜딩 페이지로 설정하는 것이 유리할 것으로 보인다.</p>
  </li>
  <li>
    <p>유료 검색 채널 최적화: Gsearch 유입 비중이 지나치게 높은 점을 고려하여, organic 및 direct 유입을 더욱 강화하는 전략이 필요하다.</p>
  </li>
</ol>

<p><br /><br />
<br /><br /></p>
<h3 id="데이터-설명">데이터 설명</h3>
<ul>
  <li>
    <p>UTM Source: 트래픽 유입 경로 (Gsearch: 구글 광고, Bsearch: 빙 광고)</p>
  </li>
  <li>
    <p>UTM Campaign: 브랜드 검색(brand)과 비브랜드 검색(nonbrand) 구분</p>
  </li>
  <li>
    <p>Sessions: 웹사이트 방문 세션 수</p>
  </li>
  <li>
    <p>Orders: 발생한 주문 수</p>
  </li>
  <li>
    <p>Device Type: 트래픽 발생 기기 (데스크탑, 모바일)</p>
  </li>
  <li>
    <p>Landing Page: 사용자 최초 방문 페이지 (/home vs. /lander-1)</p>
  </li>
</ul>

<p><br /><br />
<br /><br /></p>
<h3 id="분석과정-근거">분석과정/ 근거</h3>

<h5 id="1-gsearch의-세션수와-주문수의-월별-트렌드-보기">1. gsearch의 세션수와 주문수의 월별 트렌드 보기</h5>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">-- gsearch의 월별 세션수와 주문수 트렌드</span>
<span class="k">SELECT</span> <span class="nb">YEAR</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="nb">year</span>
     <span class="p">,</span> <span class="k">MONTH</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="k">month</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span><span class="p">)</span> 
            <span class="k">AS</span> <span class="n">gsearch_sessions</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">gsearch_orders</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span> 
            <span class="o">/</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">website_sessions_id</span><span class="p">)</span> 
            <span class="k">AS</span> <span class="n">gsearch_conversion</span>
<span class="k">FROM</span> <span class="n">website_sessions</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">orders</span> <span class="k">ON</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> 
                            <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">website_session_id</span>
<span class="k">WHERE</span> <span class="n">utm_source</span> <span class="o">=</span> <span class="s1">'gsearch'</span> <span class="k">AND</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span> <span class="o">&lt;</span> <span class="s1">'2012-11-27'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진1.png" alt="사진1" style="width: 80%;" /></p>

<p><strong>결과</strong> :</p>

<blockquote>
  <p>확실하게 세션수는 시간이 지나면서 증가하고 있다. 첫달에 1860정도에 비해, 현재는 8895의 세션이 발생한다.</p>
</blockquote>

<blockquote>
  <p>주문수 또한 성장하고 있는데, 3월달 (92건)에 비해 현재는 거의 4배인 (373건)으로 많아진걸 확인 할 수 있다.</p>
</blockquote>

<blockquote>
  <p>전환율 같은 경우에는 첫 3달에는 2.6% 정도에 머물다가, 마지막 달에는 4%까지 높아진게 보인다.</p>
</blockquote>

<p><br /><br />
<br /><br /></p>

<h5 id="2-검색-루트별-월별-트렌드-보기">2. 검색 루트별 월별 트렌드 보기</h5>

<ul>
  <li>이번엔 nonbrand/brand별로 나누어서 Gsearch의 월별 트렌드를 확인해보자.</li>
</ul>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="nb">YEAR</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="nb">year</span>
     <span class="p">,</span> <span class="k">MONTH</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="k">month</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">utm_campaign</span> <span class="o">=</span> <span class="s1">'nonbrand'</span> 
        <span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
            <span class="k">AS</span> <span class="n">nonbrand_sessions</span>
    <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">utm_campaign</span> <span class="o">=</span> <span class="s1">'nonbrand'</span> 
        <span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
            <span class="k">AS</span> <span class="n">nonbrand_orders</span>
    <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">utm_campaign</span> <span class="o">=</span> <span class="s1">'brand'</span> 
        <span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
            <span class="k">AS</span> <span class="n">brand_sessions</span>
    <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">utm_campaign</span> <span class="o">=</span> <span class="s1">'brand'</span> 
        <span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">orders</span><span class="p">.</span><span class="n">order_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
            <span class="k">AS</span> <span class="n">brand_orders</span>
<span class="k">FROM</span> <span class="n">website_sessions</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">orders</span>
        <span class="k">ON</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> 
                        <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">website_session_id</span>
<span class="k">WHERE</span> <span class="n">utm_source</span> <span class="o">=</span> <span class="s1">'gsearch'</span> <span class="k">AND</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span> <span class="o">&lt;</span> <span class="s1">'2012-11-27'</span>
<span class="k">GROUP</span> <span class="k">BY</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진2.png" alt="사진2" style="width: 80%;" /></p>

<p><strong>결과</strong>:</p>
<blockquote>
  <p>브랜드 캠페인은 검색 엔진에서 우리의 브랜드를 찾아서, 우리의 광고를 클릭해서 들어온 고객들을 나타낸다. 우리 회사는 유료 트래픽에 항상 의존해야 할까? 아니면 브랜드가 점점 인식되고 있을까? 위의 결과를 보았을때, 브랜드 세션수가 굉장히 많아 졌다. 자체 브랜드 인지도가 많이 늘었다는 걸 알수 있다.</p>
</blockquote>

<p><br /><br />
<br /><br /></p>

<h5 id="3-nonbrand-그룹의-기기별-세션수와-주문수-변화">3. nonbrand 그룹의 기기별 세션수와 주문수 변화</h5>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="nb">YEAR</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="nb">year</span>
     <span class="p">,</span> <span class="k">MONTH</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="k">month</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">device_type</span> <span class="o">=</span> <span class="s1">'desktop'</span>
		<span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
			<span class="k">AS</span> <span class="n">desktop_sessions</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">device_type</span> <span class="o">=</span> <span class="s1">'desktop'</span>
		<span class="k">THEN</span> <span class="n">orders</span><span class="p">.</span><span class="n">order_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> 
			<span class="k">AS</span> <span class="n">desktop_orders</span>
	 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">device_type</span> <span class="o">=</span> <span class="s1">'mobile'</span>
		<span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
			<span class="k">AS</span> <span class="n">mobile_sessions</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">device_type</span> <span class="o">=</span> <span class="s1">'mobile'</span>
		<span class="k">THEN</span> <span class="n">orders</span><span class="p">.</span><span class="n">order_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
			<span class="k">AS</span> <span class="n">mobile_orders</span>
<span class="k">FROM</span> <span class="n">website_sessions</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">orders</span>
		<span class="k">ON</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">website_session_id</span>
<span class="k">WHERE</span> <span class="n">utm_source</span> <span class="o">=</span> <span class="s1">'gsearch'</span>
	<span class="k">AND</span> <span class="n">utm_campaign</span> <span class="o">=</span> <span class="s1">'nonbrand'</span>
    <span class="k">AND</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span> <span class="o">&lt;</span> <span class="s1">'2012-11-27'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진3.png" alt="사진3" style="width: 100%;" /></p>

<p><strong>결과</strong>:</p>
<blockquote>
  <ul>
    <li>여기서 확인 할수 있는건, 데스트탑의 세션수가 모바일보다 훨씬 많다는 점이다. 초기에는 (데스트탑:모바일) 비율이 거의 2:1인데, 거의 뒤에 오면 3:1 수준으로 차이가 더 벌이지고 있다.
<br /><br /></li>
    <li>주문수를 확인하면 이 변화가 더 뚜렸한데, 초기에 (데스트탑:모바일) 5:1이던 비율이  10:1로 변한걸 볼수 있다.</li>
  </ul>
</blockquote>

<p><br /><br /> 
<br /><br /></p>

<h5 id="4-gsearch의-각-채널당-월별-트랜드-확인하기">4. gsearch의 각 채널당 월별 트랜드 확인하기</h5>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">utm_source</span>
     <span class="p">,</span> <span class="n">utm_campaign</span>
     <span class="p">,</span> <span class="n">http_referer</span>
<span class="k">FROM</span> <span class="n">website_sessions</span>
<span class="k">WHERE</span> <span class="n">created_at</span> <span class="o">&lt;</span> <span class="s1">'2012-11-27'</span><span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진4.png" alt="사진4" style="width: 80%;" /></p>

<p><strong>결과</strong>:</p>

<blockquote>
  <p>현재 회사의 gseach의 트래픽 비중이 너무 큰건 아닐까?  우리 회사는 현재 UTM source로 Gsearch(google)과 Bsearch(bing)이 있다. 그리고 각각 nonbrand와 brand로 나눠서 볼수 있다.</p>
</blockquote>

<blockquote>
  <p>이런 유료채널 외에도 direct typie-in과 organic 검색 채널들을 보자.(direct type-in은 링크에 검색해서  / organic search는 우리가 정의하지 않은 검색 엔진을 통해 들어온 트래픽을 나타낸다.)</p>
</blockquote>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="nb">YEAR</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="nb">year</span>
     <span class="p">,</span> <span class="k">MONTH</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="k">month</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">utm_source</span> <span class="o">=</span> <span class="s1">'gsearch'</span>
		<span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
			<span class="k">AS</span> <span class="n">gsearch_paid_sessions</span>
	<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">utm_source</span> <span class="o">=</span> <span class="s1">'bsearch'</span>
		<span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
			<span class="k">AS</span> <span class="n">bsearch_paid_sessions</span>
	<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">utm_source</span> <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">http_referer</span> 
        <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="k">ELSE</span> 
            <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
			    <span class="k">AS</span> <span class="n">organic_search_sessions</span>
	<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">utm_source</span> <span class="k">IS</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">http_referer</span>
          <span class="k">IS</span> <span class="k">NULL</span> <span class="k">THEN</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="k">ELSE</span> 
            <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span>
			    <span class="k">AS</span> <span class="n">direct_type_in_sessions</span>
<span class="k">FROM</span> <span class="n">website_sessions</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">orders</span>
		<span class="k">ON</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">website_session_id</span>
<span class="k">WHERE</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span> <span class="o">&lt;</span> <span class="s1">'2012-11-27'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진5.png" alt="사진5" style="width: 100%;" /></p>

<p><strong>결과</strong>:</p>
<blockquote>
  <p>여기서 보이는건, 처음 2개 (gsearch, bsearch) 같은 경우에는 회사에서 비용을 지불하고 있고, 세션 수가 늘면 그에 비례해서 비용도 늘어날 것이다.
하지만 뒤에 2개 (organic, direct type in) 같은 경우에는 돈을 내지 않고 있다. 그럼에도 뒤에 organic, direct 채널에서도 세션수가 늘어나고 있다는 건 긍정적인 신호이다.</p>
</blockquote>

<p><br /><br />
<br /><br /></p>

<h5 id="5-월별-웹사이트의-전환율-변화">5. 월별 웹사이트의 전환율 변화</h5>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="nb">YEAR</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="nb">year</span>
     <span class="p">,</span> <span class="k">MONTH</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">AS</span> <span class="k">month</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span><span class="p">)</span> 
        <span class="k">AS</span> <span class="n">sessions</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">orders</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">orders</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span> <span class="o">/</span>
		<span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span><span class="p">)</span> 
            <span class="k">AS</span> <span class="n">conversion_rate</span>
<span class="k">FROM</span> <span class="n">website_sessions</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">orders</span>
		<span class="k">ON</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">website_session_id</span>
<span class="k">WHERE</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span> <span class="o">&lt;</span> <span class="s1">'2012-11-27'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진6.png" alt="사진6" style="width: 80%;" /></p>

<p><strong>결과</strong>:</p>
<blockquote>
  <p>전환율 같은 경우에는 4월에는 2.6% 였지만, 점점 증가하다가 4.4%까지 개선된걸 볼수 있다.</p>
</blockquote>

<p><br /><br />
<br /><br /></p>

<h5 id="6-ab-테스트-랜딩-페이지별-수익-비교">6. A/B 테스트 (랜딩 페이지별 수익 비교)</h5>
<p>*홈페이지 관리자가 만든 새로운 랜딩 페이지(/lander-1)와 기존 홈페이지(/home)을 6월 17일 부터 6월 28일 까지 시험적으로 사용해 보았을때, 어떤 페이지가 더 많은 수익을 발생시켰을까?</p>

<h6 id="step-1-테스트-시작-시점-찾기">Step 1: 테스트 시작 시점 찾기.</h6>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="k">MIN</span><span class="p">(</span><span class="n">website_pageview_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">first_test_pv</span>
<span class="k">FROM</span> <span class="n">website_pageviews</span>
<span class="k">WHERE</span> <span class="n">pageview_url</span> <span class="o">=</span> <span class="s1">'/lander-1'</span><span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진7.png" alt="사진7" style="width: 80%;" /></p>

<blockquote>
  <p>/lander-1의 첫 페이지뷰 Id(23504)를 가져와서 테스트의 시작 시점을 확인하자.</p>
</blockquote>

<p><br /><br /></p>
<h6 id="step-2-테스트-기간동안의-세션-데이터-가져오기">Step 2: 테스트 기간동안의 세션 데이터 가져오기.</h6>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="n">first_test_pageview</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TEMPORARY</span> <span class="k">TABLE</span> <span class="n">first_test_pageview</span>
<span class="k">SELECT</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span>
     <span class="p">,</span> <span class="k">MIN</span><span class="p">(</span><span class="n">website_pageviews</span><span class="p">.</span><span class="n">website_pageview_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">min_pageview_id</span>
<span class="k">FROM</span> <span class="n">website_pageviews</span>
	<span class="k">JOIN</span> <span class="n">website_sessions</span>
		<span class="k">ON</span> <span class="n">website_pageviews</span><span class="p">.</span><span class="n">website_session_id</span> <span class="o">=</span> 
			<span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span>
<span class="k">WHERE</span> <span class="n">website_pageviews</span><span class="p">.</span><span class="n">website_pageview_id</span> <span class="o">&gt;=</span> <span class="s1">'23504'</span>
	<span class="k">AND</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span> <span class="o">&lt;</span> <span class="s1">'2012-07-28'</span>
    <span class="k">AND</span> <span class="n">utm_source</span> <span class="o">=</span> <span class="s1">'gsearch'</span>
	<span class="k">AND</span> <span class="n">utm_campaign</span> <span class="o">=</span> <span class="s1">'nonbrand'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span>
<span class="p">;</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">first_test_pageview</span>
<span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진8.png" alt="사진8" style="width: 80%;" /></p>

<blockquote>
  <p>테스트 기간동안의 gsearch nonbrand의 트래픽 중에, 각 세션별로 첫 페이지뷰(랜딩 페이지)를 찾는다.</p>
</blockquote>

<p><br /><br /></p>
<h6 id="step-3-랜딩-페이지-매핑하기">Step 3: 랜딩 페이지 매핑하기.</h6>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="n">nonbrand_test_sessions_landing_pages</span>
<span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TEMPORARY</span> <span class="k">TABLE</span> <span class="n">nonbrand_test_sessions_landing_pages</span>
<span class="k">SELECT</span> <span class="n">website_pageviews</span><span class="p">.</span><span class="n">website_session_id</span>
     <span class="p">,</span> <span class="n">pageview_url</span> <span class="k">AS</span> <span class="n">landing_page</span>
<span class="k">FROM</span> <span class="n">first_test_pageview</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">website_pageviews</span>
		<span class="k">ON</span> <span class="n">first_test_pageview</span><span class="p">.</span><span class="n">min_pageview_id</span> <span class="o">=</span>
			<span class="n">website_pageviews</span><span class="p">.</span><span class="n">website_pageview_id</span>
<span class="k">WHERE</span> <span class="n">pageview_url</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'/home'</span><span class="p">,</span> <span class="s1">'/lander-1'</span><span class="p">)</span>
<span class="p">;</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">nonbrand_test_sessions_landing_pages</span>
<span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진9.png" alt="사진9" style="width: 80%;" /></p>

<blockquote>
  <p>각 세션의 랜딩 페이지를 기반으로, 각각의 세션이 /home 또는 /lander-1 중에서 어떤 랜딩 페이지인지 매핑을 한다. 다시 말해, 어떤 랜딩 페이지를 통해 사용자가 유입되었는지 식별하기 위한 작업이다.</p>
</blockquote>

<p><br /><br /></p>

<h6 id="step-4-세션별로-주문이-발생했는지-확인하자">Step 4: 세션별로 주문이 발생했는지 확인하자.</h6>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="n">nonbrand_test_session_orders</span>
<span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TEMPORARY</span> <span class="k">TABLE</span> <span class="n">nonbrand_test_session_orders</span>
<span class="k">SELECT</span> <span class="n">nonbrand_test_sessions_landing_pages</span><span class="p">.</span><span class="n">website_session_id</span>
     <span class="p">,</span> <span class="n">nonbrand_test_sessions_landing_pages</span><span class="p">.</span><span class="n">landing_page</span>
     <span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">order_id</span>
<span class="k">FROM</span> <span class="n">nonbrand_test_sessions_landing_pages</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">orders</span>
		<span class="k">ON</span> <span class="n">nonbrand_test_sessions_landing_pages</span><span class="p">.</span><span class="n">website_session_id</span> 
            <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">website_session_id</span>
<span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">nonbrand_test_session_orders</span>
<span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진10.png" alt="사진10" style="width: 80%;" /></p>

<blockquote>
  <p>각 세션 id를 기준으로 주문 데이터와 연결한다. 이를 통해 각각의 세션에서 실제로 주문으로 이어졌는지 알수있다.</p>
</blockquote>

<p><br /><br /></p>
<h6 id="step-5-전환율-계산하기">Step 5: 전환율 계산하기</h6>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">-- /home 과 /lander-1의 성과를 비교하기 위해 전환율을 계산하자 </span>
<span class="c1">-- (전환율 = 주문 수 / 세션 수). </span>

<span class="k">SELECT</span> <span class="n">landing_page</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">website_session_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">sessions</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">order_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">orders</span>
     <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">order_id</span><span class="p">)</span> 
        <span class="o">/</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">website_session_id</span><span class="p">)</span> 
        <span class="k">AS</span> <span class="n">conv_rate</span>
<span class="k">FROM</span> <span class="n">nonbrand_test_session_orders</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span>
<span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진11.png" alt="사진11" style="width: 80%;" /></p>

<p><strong>결과</strong>:</p>
<blockquote>
  <ul>
    <li>/home의 전환율: 3.18%</li>
    <li>/lander-1의 전환율: 4.06%</li>
    <li>/lander-1의 전환율이 더 높음  ⇒ 약 0.88%의 추가 전환율.</li>
  </ul>
</blockquote>

<p><br /><br /></p>
<h6 id="step-6-가장-최근에-home으로-랜딩된-세션-찾기">Step 6: 가장 최근에 /home으로 랜딩된 세션 찾기.</h6>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="k">MAX</span><span class="p">(</span><span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span><span class="p">)</span> 
        <span class="k">AS</span> <span class="n">most_recent_gsearch_nonbrand_home_session</span>
<span class="k">FROM</span> <span class="n">website_sessions</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">website_pageviews</span>
		<span class="k">ON</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">website_session_id</span> 
            <span class="o">=</span> <span class="n">website_pageviews</span><span class="p">.</span><span class="n">website_session_id</span>
<span class="k">WHERE</span> <span class="n">utm_source</span> <span class="o">=</span> <span class="s1">'gsearch'</span>
	<span class="k">AND</span> <span class="n">utm_campaign</span> <span class="o">=</span> <span class="s1">'nonbrand'</span>
    <span class="k">AND</span> <span class="n">pageview_url</span> <span class="o">=</span> <span class="s1">'/home'</span>
    <span class="k">AND</span> <span class="n">website_sessions</span><span class="p">.</span><span class="n">created_at</span> <span class="o">&lt;</span> <span class="s1">'2012-11-27'</span>
    <span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진12.png" alt="사진12" style="width: 80%;" /></p>

<p><strong>결과</strong>:</p>
<blockquote>
  <p>가장 최근에 /home 페이지로 연결된 트래픽의 세션 id를 찾아보니, ‘17145’인걸 알수 있음. 이 이후에는 새로운 /lander-1으로 트래픽이 리라우팅 되었다.</p>
</blockquote>

<p><br /><br /></p>
<h6 id="step-7-추가-주문-수-계산하기">Step 7: 추가 주문 수 계산하기</h6>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
	<span class="k">COUNT</span><span class="p">(</span><span class="n">website_session_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">sessions_since_test</span>
<span class="k">FROM</span> <span class="n">website_sessions</span>
<span class="k">WHERE</span> <span class="n">created_at</span> <span class="o">&lt;</span> <span class="s1">'2012-11-27'</span>
	<span class="k">AND</span> <span class="n">website_session_id</span> <span class="o">&gt;</span> <span class="mi">17145</span>
    <span class="k">AND</span> <span class="n">utm_source</span> <span class="o">=</span> <span class="s1">'gsearch'</span>
    <span class="k">AND</span> <span class="n">utm_campaign</span> <span class="o">=</span> <span class="s1">'nonbrand'</span>
<span class="p">;</span></code></pre></figure>

<p><img src="/assets/pngs/사진13.png" alt="사진13" style="width: 80%;" /></p>

<p><strong>결과</strong>:</p>
<blockquote>
  <p>테스트가 끝난 후에 발생한 총 세션수: 22972.</p>
</blockquote>

<ol>
  <li>추가 주문 수 계산하기:
    <ul>
      <li>증가한 전환율(0.0088)로 인해 발생한 추가 주문 수 계산을 한다면:</li>
      <li>
        <p>추가 주문 수  =  총 세션 수 x 추가 전환율</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   = 22,988 x 0.0088     ≈ 202
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>월별 추가 주문 수 계산하기:</li>
</ol>

<ul>
  <li>실험 이후 약 4개월 간의 데이터를 바탕으로 계산하면,
    <ul>
      <li>202 / 4 = 50.5</li>
      <li>월평균 약 50건의 추가 주문이 발생한걸 알수있다.</li>
    </ul>
  </li>
</ul>


</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>Hyunwoo Park</strong>
  </small>

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="mailto:hwcollege2019@gmail.com"
       style="color: #6c757d"
       onMouseOver="this.style.color='#db4437'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.github.com/jnaiman"
       style="color: #6c757d"
       onMouseOver="this.style.color='#333333'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.twitter.com/your_username"
       style="color: #6c757d"
       onMouseOver="this.style.color='#1da1f2'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-twitter fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.youtube.com/your_channel_name"
       style="color: #6c757d"
       onMouseOver="this.style.color='#ff0000'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-youtube fa-1x"></i>
    </a>

</div>

  Theme by <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a> and <a href="https://github.com/4dcu-be/4dcu.be">4dcu.be</a>.

  
<!--<small id="attribution">
    theme <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a>
  </small>
-->

</footer>


<!-- Custom page specific js files -->
  
    <script src='/assets/js/vega.min.js' type="text/javascript"></script>
  
    <script src='/assets/js/vega-lite.min.js' type="text/javascript"></script>
  
    <script src='/assets/js/vega-embed.min.js' type="text/javascript"></script>
  
    <script src='/assets/js/justcharts.js' type="text/javascript"></script>
  



  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

<!--
end of checks! JPN
-->

</html>














