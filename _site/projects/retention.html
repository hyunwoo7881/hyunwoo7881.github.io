<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by Youssef Raafat
  Free for personal and commercial use under the MIT license
  https://github.com/YoussefRaafatNasry/portfolYOU
  Updates for JPN Fall 2024
  FALL2024ID49073
-->

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="SQL 분석 프로젝트 - 온라인 리테일(리텐션 분석)">
  <meta property="og:description" content="This project visualizes key online retail company's metrics, exploring customers' purchasing pattern.">
  <meta property="og:image" content="assets/pngs/retention/rt2.jpg">

  <title>SQL 분석 프로젝트 - 온라인 리테일(리텐션 분석)</title>
  <meta name="description" content="This project visualizes key online retail company's metrics, exploring customers' purchasing pattern.">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>

<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>Hyunwoo Park's Resume</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link " href="/license_trends">My GitHub Pages with Streamlit</a>

      <a class="nav-item nav-link active" href="/projects/">Projects</a>

      <a class="nav-item nav-link " href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  <h4 id="sql-분석-프로젝트---온라인-리테일-리텐션-분석">SQL 분석 프로젝트 - 온라인 리테일 (리텐션 분석)</h4>
<p><br /><br /></p>

<h4 id="분석의-목적">분석의 목적</h4>
<p>온라인 리테일 회사의 고객 재구매 패턴과 유지율(Retention Rate)을 분석하여, 고객 이탈을 줄이고 장기적인 충성도를 높이는 전략을 수립하는 것임. 이를 위해, 클래식 리텐션과 롤링 리텐션을 비교하여 고객의 재방문 패턴을 이해하고, 효과적인 리텐션 전략을 도출하는 것이 목표.</p>

<p><br /><br /></p>

<p><strong>초기, 중기, 장기적인</strong> 관점에서,</p>

<p>1️⃣ <strong>신규 고객의 이탈률은 얼마나 높은가?</strong></p>
<ul>
  <li>첫 구매 후 일정 기간 내 이탈하는 고객 비율을 파악하여, 초기 리텐션을 개선할 방법을 찾는다.</li>
</ul>

<p>2️⃣ <strong>고객이 다시 돌아오는 패턴이 존재하는가?</strong></p>
<ul>
  <li>특정 기간(예: 6개월~9개월 후)에 고객이 재방문하는지 확인하여, 재참여(Re-engagement) 전략을 설계한다.</li>
</ul>

<p>3️⃣ <strong>충성 고객의 특징은 무엇인가?</strong></p>
<ul>
  <li>장기적으로 브랜드와 관계를 유지하는 고객이 얼마나 되는지 분석하여, VIP 고객을 위한 맞춤 전략을 마련한다.</li>
</ul>

<p><br /><br /></p>

<h4 id="결과">결과</h4>
<ol>
  <li>신규 고객 이탈률이 높음  —&gt; 초기 고객 유지 전략이 필요함.
    <ol>
      <li><code class="language-plaintext highlighter-rouge">month_1</code>(첫 구매 후 1개월 차)에서 고객 수가 급감함.</li>
      <li>많은 고객이 한번 구매 후 더이상 구매하지 않음.</li>
      <li>이는 온보딩 경험 부족 또는 첫 구매 후 추가적인 유입 유도가 부족한 것일 수도 있음.
<br /><br /></li>
    </ol>
  </li>
  <li>일정 기간 후 고객이 다시 돌아오는 경향 존재 —&gt; 재참여 전략 필요.
    <ol>
      <li>클래식 리텐션에서 <code class="language-plaintext highlighter-rouge">month_8</code>~<code class="language-plaintext highlighter-rouge">month_9</code>에 고객 수가 증가하는 패턴 발견.</li>
      <li>고객이 특정 시점(할인 행사, 시즌 이벤트 등)에 돌아올 가능성이 높음.</li>
      <li>이는 고객의 재구매 주기가 존재할 가능성이 높으며, 프로모션의 영향을 받는것일 수도 있음.</li>
    </ol>
  </li>
</ol>

<p><br /><br /></p>

<h4 id="제안">제안</h4>
<ol>
  <li><strong>신규 고객 유치 전략 (초기 리텐션 개선)</strong>
    <ol>
      <li>첫 구매 후 30일 내 추가 구매 유도 → “Welcome 리텐션 캠페인” 실행
        <ol>
          <li>목표: 첫 구매 후 1개월 내 재구매율을 높여 month_1 이탈률 줄이기.</li>
          <li>방법:
            <ol>
              <li>첫 구매 후 “재방문 유도 할인 쿠폰” 제공 (ex. 첫 구개 감사 쿠폰! 30일 이내 사용 가능)</li>
              <li>개인화된 추천 제품 전송 (첫 구매 제품과 연관된 상품 추천 → 같이 잘팔리는 상품 조합을 추후에 분석해 볼수 있음  Market Basket Analysis)</li>
              <li>푸시 알림 &amp; 리마인더 메시지 활용 (이전 관련 상품과 연관된 상품등으로 + 대신 알림 메시지 활용이 정말 필요한지에 대한 접근은 좀더 조심히 해야함)
<br /><br /></li>
            </ol>
          </li>
        </ol>
      </li>
    </ol>
  </li>
  <li><strong>고객 재참여 전략 (휴면 고객 활성화)</strong>
    <ol>
      <li>특정 기간 이후 다시 돌아온 고객을 대상을로 “재활성화 프로모션” 진행.
        <ol>
          <li>목표: 특정 월(<code class="language-plaintext highlighter-rouge">month_8</code>, <code class="language-plaintext highlighter-rouge">month_9</code>)에 다시 증가하는 고객을 효과적으로 타겟팅하여 리텐션 향상.</li>
          <li>방법:
            <ol>
              <li>장기 미구매 고객에게 “재방문 특별 혜택” 제공 (ex. “오랜만이에요! 돌아와 주셔서 감사합니다. 특별 10% 할인 쿠폰 증정”)</li>
              <li>이탈 고객을 위한 맞춤형 이메일 캠페인 (개인 맞춤 상품 추천)
<br /><br /></li>
            </ol>
          </li>
        </ol>
      </li>
    </ol>
  </li>
  <li><strong>충성 고객 대상</strong>
    <ol>
      <li>재구매 패턴이 있는 고객을 대상으로 구독 모델 &amp; 멤버십 프로그램 도입
        <ol>
          <li>목표: 롤링 리텐션에서 나타난 “장기 유지 고객”을 더욱 락인하여, 이탈을 줄이고 LTV(Customer Lifetime Value)를 극대화.</li>
          <li>방법:
            <ul>
              <li>“프리미엄 멤버십” 도입 (예: “VIP 고객 전용 무료 배송 &amp; 특별 할인”)</li>
              <li>정기구독 모델 도입 (예: “매달 필요한 제품을 자동으로 받아보세요! 정기구독 할인 적용”)</li>
              <li>포인트 적립 &amp; 리워드 시스템 (예: “3개월 연속 구매 시 추가 할인 혜택 제공”)</li>
            </ul>
          </li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

<p><br /><br />
<br /><br /></p>
<h3 id="데이터-설명">데이터 설명</h3>
<p><strong>클래식 리텐션</strong></p>

<p><img src="/assets/pngs/retention/rt1.jpg" alt="사진1" style="width: 100%;" /></p>

<ul>
  <li><strong>클래식 리텐션은 특정 코호트에서 특정 달에 다시 구매한 고객 수를 나타냄.</strong></li>
  <li><code class="language-plaintext highlighter-rouge">month_0</code>(첫 구매 달) 이후, <code class="language-plaintext highlighter-rouge">month_1</code>부터 급격히 감소하는 패턴을 보임.</li>
  <li>하지만 <strong>몇몇 코호트에서 특정 달(<code class="language-plaintext highlighter-rouge">month_8</code>, <code class="language-plaintext highlighter-rouge">month_9</code> 등)에 고객 수가 증가하는 패턴</strong>이 나타남.
    <ul>
      <li>이는 고객이 일정 기간 구매를 하지 않다가 다시 돌아오는 경우가 있음을 의미함.</li>
      <li>예를 들어, <code class="language-plaintext highlighter-rouge">2011-01-01</code> 코호트에서 <code class="language-plaintext highlighter-rouge">month_8</code>(8개월 차)에서 131명으로 다시 증가.</li>
    </ul>
  </li>
  <li><strong>즉, 고객의 재구매 행동이 일정한 간격을 두고 발생하는 경향이 있음.</strong>
    <ul>
      <li>시즌 할인, 프로모션, 이메일 마케팅 효과 가능성이 있음.</li>
      <li>제품의 소비 주기가 존재할 가능성 있음.</li>
    </ul>
  </li>
</ul>

<p><br /><br /></p>

<p><strong>클래식 리텐션</strong></p>

<p><img src="/assets/pngs/retention/rt2.jpg" alt="사진2" style="width: 100%;" /></p>

<ul>
  <li><strong>롤링 리텐션은 고객이 한 번이라도 돌아오면 이탈하지 않은 것으로 간주되므로, 값이 더 높게 유지됨.</strong></li>
  <li><code class="language-plaintext highlighter-rouge">month_0</code> 이후에도 <code class="language-plaintext highlighter-rouge">month_N</code>에서 여전히 높은 고객 수 유지.</li>
  <li><strong>클래식 리텐션보다 훨씬 천천히 감소하는 형태</strong>를 띄며, <code class="language-plaintext highlighter-rouge">month_6</code> 이후에도 일정 수준 이상 유지됨.</li>
  <li><strong>고객들이 일정 주기로 돌아오는 패턴이 확인됨</strong> → 고객이 브랜드를 완전히 이탈하지 않고 재구매하는 성향이 있음.</li>
</ul>

<p><br /><br />
<br /><br /></p>
<h4 id="쿼리">쿼리</h4>
<ol>
  <li>클랙식 리텐션 쿼리
    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- 날짜 형식을 시간을 제외해줌</span>
<span class="k">WITH</span> <span class="n">id_and_new_date</span> <span class="k">AS</span> <span class="p">(</span> 
 <span class="k">SELECT</span> <span class="n">CustomerID</span>
 <span class="p">,</span> <span class="n">PARSE_DATE</span><span class="p">(</span><span class="nv">"%Y.%m.%d"</span><span class="p">,</span> <span class="n">REGEXP_REPLACE</span><span class="p">(</span><span class="n">InvoiceDate</span><span class="p">,</span> 
             <span class="n">r</span><span class="s1">'[</span><span class="se">\s</span><span class="s1">].*'</span><span class="p">,</span> <span class="nv">""</span><span class="p">))</span>  <span class="k">as</span> <span class="n">invoiceDate</span>
 <span class="k">FROM</span> <span class="nv">`eminent-ring-451902-n9.ai. new_table`</span>
 <span class="k">WHERE</span> <span class="n">CustomerID</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span>
    <span class="k">and</span> <span class="n">CustomerID</span> <span class="o">!=</span> <span class="nv">"CustomerID"</span>
<span class="p">),</span> <span class="n">purch_months</span> <span class="k">AS</span> <span class="p">(</span>  <span class="c1">-- 구매한 달과 가장 처음 구매한 달</span>
 <span class="k">SELECT</span> <span class="n">CustomerID</span>
  <span class="p">,</span> <span class="n">invoiceDate</span>
  <span class="p">,</span> <span class="n">DATE_TRUNC</span><span class="p">(</span><span class="n">invoiceDate</span><span class="p">,</span> <span class="k">MONTH</span><span class="p">)</span> 
         <span class="k">as</span> <span class="n">purchase_month</span>
  <span class="p">,</span> <span class="n">DATE_TRUNC</span><span class="p">(</span><span class="k">MIN</span><span class="p">(</span><span class="n">invoiceDate</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">CustomerID</span> 
     <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">invoiceDate</span><span class="p">),</span> <span class="k">MONTH</span><span class="p">)</span> 
         <span class="k">as</span> <span class="n">first_purchase_month</span>
 <span class="k">FROM</span> <span class="n">id_and_new_date</span>
<span class="p">),</span> <span class="n">records_preprocessed</span> <span class="k">AS</span> <span class="p">(</span> <span class="c1">-- 구매한 달과 처음 구매한 달 차이 = 코호트 달</span>
 <span class="k">SELECT</span> <span class="o">*</span>
  <span class="p">,</span> <span class="n">CONCAT</span><span class="p">(</span><span class="nv">"month_"</span><span class="p">,</span> <span class="n">DATE_DIFF</span><span class="p">(</span><span class="n">purchase_month</span><span class="p">,</span> 
             <span class="n">first_purchase_month</span><span class="p">,</span> <span class="k">MONTH</span><span class="p">))</span>
                 <span class="k">as</span> <span class="n">cohort_month</span>
 <span class="k">FROM</span> <span class="n">purch_months</span>
<span class="p">)</span>  <span class="c1">-- 처음 구매한 달과 코호트 달을 기준으로 피벗</span>
<span class="k">SELECT</span> <span class="n">first_purchase_month</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_0'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_0</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_1'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_1</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_2'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_2</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_3'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_3</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_4'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_4</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_5'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_5</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_6'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_6</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_7'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_7</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_8'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_8</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_9'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_9</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_10'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_10</span>
 <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cohort_month</span> <span class="o">=</span> <span class="s1">'month_11'</span> 
         <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">month_11</span>
<span class="k">FROM</span> <span class="n">records_preprocessed</span>
<span class="k">WHERE</span> <span class="n">first_purchase_month</span> <span class="o">&gt;=</span> <span class="s1">'2010-12-31'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">first_purchase_month</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">first_purchase_month</span>
<span class="p">;</span>
</code></pre></div>    </div>
  </li>
</ol>

<p><img src="/assets/pngs/retention/rt3.jpg" alt="사진3" style="width: 120%;" /></p>

<p><br /><br /></p>

<ol>
  <li>롤링 리텐션 쿼리
    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span> <span class="n">id_and_new_date</span> <span class="k">AS</span> <span class="p">(</span> <span class="c1">-- 날짜 형식을 시간을 제외해줌</span>
<span class="k">SELECT</span> <span class="n">CustomerID</span>
 <span class="p">,</span> <span class="n">PARSE_DATE</span><span class="p">(</span><span class="nv">"%Y.%m.%d"</span><span class="p">,</span> <span class="n">REGEXP_REPLACE</span><span class="p">(</span><span class="n">InvoiceDate</span><span class="p">,</span> 
             <span class="n">r</span><span class="s1">'[</span><span class="se">\s</span><span class="s1">].*'</span><span class="p">,</span> <span class="nv">""</span><span class="p">))</span> <span class="k">as</span> <span class="n">invoiceDate</span>
<span class="k">FROM</span> <span class="nv">`eminent-ring-451902-n9.ai. new_table`</span>
<span class="k">WHERE</span> <span class="n">CustomerID</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span>
   <span class="k">and</span> <span class="n">CustomerID</span> <span class="o">!=</span> <span class="nv">"CustomerID"</span>
<span class="p">),</span> <span class="n">purch_months</span> <span class="k">AS</span> <span class="p">(</span> <span class="c1">-- 구매한 달과 가장 처음 구매한 달 + 마지막 구매한 달</span>
<span class="k">SELECT</span> <span class="n">CustomerID</span>
 <span class="p">,</span> <span class="n">invoiceDate</span>
 <span class="p">,</span> <span class="n">DATE_TRUNC</span><span class="p">(</span><span class="n">invoiceDate</span><span class="p">,</span> <span class="k">MONTH</span><span class="p">)</span> <span class="k">as</span> <span class="n">purchase_month</span>
 <span class="p">,</span> <span class="n">DATE_TRUNC</span><span class="p">(</span><span class="k">MIN</span><span class="p">(</span><span class="n">invoiceDate</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">CustomerID</span> 
         <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">invoiceDate</span><span class="p">),</span> <span class="k">MONTH</span><span class="p">)</span> 
             <span class="k">as</span> <span class="n">first_purchase_month</span>
 <span class="p">,</span> <span class="n">DATE_TRUNC</span><span class="p">(</span><span class="k">MAX</span><span class="p">(</span><span class="n">invoiceDate</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">CustomerID</span> 
         <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">invoiceDate</span><span class="p">),</span> <span class="k">MONTH</span><span class="p">)</span> 
             <span class="k">as</span> <span class="n">last_purchase_month</span>
<span class="k">FROM</span> <span class="n">id_and_new_date</span>
<span class="p">)</span>
<span class="c1">-- 롤링 리텐션 - 월별 구매</span>
<span class="k">SELECT</span> <span class="n">first_purchase_month</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">CustomerID</span><span class="p">)</span> <span class="k">as</span> <span class="n">month_0</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">1</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> 
         <span class="k">AS</span> <span class="n">month_1</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">2</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> 
         <span class="k">AS</span> <span class="n">month_2</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">3</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> 
         <span class="k">AS</span> <span class="n">month_3</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">4</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> 
         <span class="k">AS</span> <span class="n">month_4</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">5</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> 
         <span class="k">AS</span> <span class="n">month_5</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">6</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> 
         <span class="k">AS</span> <span class="n">month_6</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">7</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> 
         <span class="k">AS</span> <span class="n">month_7</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">8</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> 
         <span class="k">AS</span> <span class="n">month_8</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">9</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span> 
         <span class="k">AS</span> <span class="n">month_9</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">10</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span>
         <span class="k">AS</span> <span class="n">month_10</span>
<span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="n">first_purchase_month</span><span class="p">,</span> 
     <span class="n">INTERVAL</span> <span class="mi">11</span> <span class="k">month</span><span class="p">)</span> <span class="o">=</span> <span class="n">purchase_month</span> <span class="k">THEN</span> <span class="n">CustomerID</span> <span class="k">END</span><span class="p">)</span>
         <span class="k">AS</span> <span class="n">month_11</span>
<span class="k">FROM</span> <span class="n">purch_months</span>
<span class="k">WHERE</span> <span class="n">first_purchase_month</span> <span class="o">&gt;=</span> <span class="s1">'2010-12-31'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">first_purchase_month</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">first_purchase_month</span>
<span class="p">;</span>
</code></pre></div>    </div>
    <p><img src="/assets/pngs/retention/rt4.jpg" alt="사진4" style="width: 120%;" />
<br /><br /></p>
  </li>
</ol>

</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>Hyunwoo Park</strong>
  </small>

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="mailto:hwcollege2019@gmail.com"
       style="color: #6c757d"
       onMouseOver="this.style.color='#db4437'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.github.com/jnaiman"
       style="color: #6c757d"
       onMouseOver="this.style.color='#333333'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.twitter.com/your_username"
       style="color: #6c757d"
       onMouseOver="this.style.color='#1da1f2'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-twitter fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.youtube.com/your_channel_name"
       style="color: #6c757d"
       onMouseOver="this.style.color='#ff0000'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-youtube fa-1x"></i>
    </a>

</div>

  Theme by <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a> and <a href="https://github.com/4dcu-be/4dcu.be">4dcu.be</a>.

  
<!--<small id="attribution">
    theme <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a>
  </small>
-->

</footer>


<!-- Custom page specific js files -->
  
    <script src='/assets/js/vega.min.js' type="text/javascript"></script>
  
    <script src='/assets/js/vega-lite.min.js' type="text/javascript"></script>
  
    <script src='/assets/js/vega-embed.min.js' type="text/javascript"></script>
  
    <script src='/assets/js/justcharts.js' type="text/javascript"></script>
  



  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

<!--
end of checks! JPN
-->

</html>














